
cd /r1/people/steffi_grote/R_packages/FuncBlocks_package

# termtables downloaded from (last modified: 07-Jan-2017)
http://archive.geneontology.org/latest-full/
go_monthly-termdb-tables.tar.gz
# keep term.txt, term2term.txt, graph_path.txt
# TODO: check 'Local GO mirror' on http://www.geneontology.org/page/lead-database-guide if dierctory above is not updated anymore

# go gene association file "mart_export.csv" downloaded from
http://grch37.ensembl.org/biomart/martview/
Database: Ensembl Genes
Dataset: Homo sapiens genes (GRCh37.p13)
Filters: none
Attributes: GO Term Accession, HGNC symbol
19684 Genes
delimiter: csv
unique results only: yes

# gene positions file "gene_coords.csv" downloaded from
http://grch37.ensembl.org/biomart/martview/
Database: Ensembl Genes
Dataset: Homo sapiens genes (GRCh37.p13)
Filters: none
Attributes: HGNC symbol, Chromosome Name, Gene Start (bp), Gene End (bp)
33671 Genes
delimiter: csv
unique results only: yes

# NEW go gene association file "mart_export_mouse.csv" downloaded from
http://www.ensembl.org/biomart/martview/
Database: Ensembl Genes 87
Dataset: Mouse genes (GRCm38.p5)
Filters: none
Attributes: GO Term Accession, Associated Gene Name
22635 Genes (21436)
delimiter: csv
unique results only: yes

# NEW gene positions for mouse "gene_coords_mouse.csv" downloaded from 
http://www.ensembl.org/biomart/martview/
Database: Ensembl Genes 87
Dataset: Mouse genes (GRCm38.p5)
Filters: none
Attributes: Associated Gene Name, Chromosome/scaffold name, Gene Start (bp), Gene End (bp)
49845 Genes (49544)
delimiter: csv
unique results only: yes

####### add files to package 
# (R-objects saved in /R/sysdata.rda can be used in the package's R functions without any explicit loading)
# in R: 
rm(list=ls())
setwd("/r1/people/steffi_grote/R_packages/FuncBlocks_package")


##### ontology
term = read.table("term_tables/term.txt", sep="\t", quote="", comment.char="", as.is=TRUE)
term2term = read.table("term_tables/term2term.txt", sep="\t", quote="", comment.char="", as.is=TRUE)
graph_path = read.table("term_tables/graph_path.txt", sep="\t", quote="", comment.char="", as.is=TRUE)



##### GO-annotations
## hg19
go_anno_grch37 = read.csv("mart_export.csv", as.is=TRUE)
# remove empty fields here to save space, but keep removing in go_enrich for custom user annotation
go_anno_grch37 = go_anno_grch37[go_anno_grch37[,1] != "",]

## mouse
go_anno_grcm38 = read.csv("mart_export_mouse.csv", as.is=TRUE) # TODO: remove!
go_anno_grcm38 = go_anno_grcm38[go_anno_grcm38[,1] != "",]



##### gene-coordinates
## hg19
gene_coords_grch37 = read.csv("gene_coords.csv", header=T, as.is=T)
# convert to bed-like-file (although ensembl 1-based), remove empty fields and reduce to chr1-22,X,Y
gene_coords_grch37 = gene_coords_grch37[,c(2,3,4,1)]
gene_coords_grch37 = gene_coords_grch37[gene_coords_grch37[,4] != "",]
gene_coords_grch37 = gene_coords_grch37[gene_coords_grch37[,1] %in% c(1:22,"X","Y"),]
# to allow usage of get_genes_from_regions.R from ABAEnrichment without modification
# (take gene-names as hgnc-symbol internally although this is not always identical -- but renaming everything to gene-symbol, also in ABAEnrichment woudl be painful)
colnames(gene_coords_grch37) = c("chr","start","end","hgnc_symbol")
gene_coords_grch37 = gene_coords_grch37[order(gene_coords_grch37$chr,gene_coords_grch37$start,gene_coords_grch37$end),]

## mouse
gene_coords_grcm38 = read.csv("gene_coords_mouse.csv", header=T, as.is=T)
gene_coords_grcm38 = gene_coords_grcm38[,c(2,3,4,1)]
gene_coords_grcm38 = gene_coords_grcm38[gene_coords_grcm38[,4] != "",]
gene_coords_grcm38 = gene_coords_grcm38[gene_coords_grcm38[,1] %in% c(1:22,"X","Y"),]
colnames(gene_coords_grcm38) = c("chr","start","end","hgnc_symbol")
gene_coords_grcm38 = gene_coords_grcm38[order(gene_coords_grcm38$chr,gene_coords_grcm38$start,gene_coords_grcm38$end),]


save(list=ls(),file="./FuncBlocks/R/sysdata.rda")


